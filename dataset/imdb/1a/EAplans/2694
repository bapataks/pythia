                                                                                                                                                                                                                                                                                                                    QUERY PLAN                                                                                                                                                                                                                                                                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=384211.47..384211.48 rows=1 width=8) (actual time=1144.629..1144.636 rows=1 loops=1)
   Buffers: shared hit=67132 read=47460
   ->  Nested Loop  (cost=7081.83..384211.47 rows=1 width=0) (actual time=50.150..1144.560 rows=104 loops=1)
         Buffers: shared hit=67132 read=47460
         ->  Hash Join  (cost=7081.40..384206.83 rows=2 width=4) (actual time=50.102..1140.832 rows=107 loops=1)
               Hash Cond: (ci.role_id = rt.id)
               Buffers: shared hit=66824 read=47340
               ->  Nested Loop  (cost=7080.22..384205.60 rows=14 width=8) (actual time=49.984..1140.292 rows=3385 loops=1)
                     Buffers: shared hit=66823 read=47340
                     ->  Nested Loop  (cost=7079.78..384161.95 rows=1 width=12) (actual time=49.939..1097.515 rows=122 loops=1)
                           Buffers: shared hit=65361 read=45153
                           ->  Nested Loop  (cost=7079.78..384159.52 rows=1 width=16) (actual time=49.933..1096.207 rows=122 loops=1)
                                 Buffers: shared hit=65239 read=45153
                                 ->  Nested Loop  (cost=7079.78..384157.10 rows=1 width=20) (actual time=49.908..1094.563 rows=122 loops=1)
                                       Buffers: shared hit=65117 read=45153
                                       ->  Hash Join  (cost=7079.35..379152.70 rows=117 width=12) (actual time=21.190..410.483 rows=5462 loops=1)
                                             Hash Cond: (t.kind_id = kt.id)
                                             Buffers: shared hit=23163 read=11126
                                             ->  Nested Loop  (cost=7078.19..379150.68 rows=205 width=16) (actual time=21.154..408.841 rows=6444 loops=1)
                                                   Buffers: shared hit=23162 read=11126
                                                   ->  Bitmap Heap Scan on movie_info mi1  (cost=7077.76..377307.58 rows=219 width=8) (actual time=21.118..196.069 rows=6699 loops=1)
                                                         Recheck Cond: (info_type_id = 18)
                                                         Filter: ((info)::text = ANY ('{"Bradbury Building - 304 S. Broadway, Downtown, Los Angeles, California, USA","Brooklyn, New York City, New York, USA",China,"Malibu, California, USA","Matera, Basilicata, Italy","New Westminster, British Columbia, Canada","Oahu, Hawaii, USA","Panama City, Panama","Philadelphia, Pennsylvania, USA","Providence, Rhode Island, USA","Sydney, New South Wales, Australia","Tribeca, Manhattan, New York City, New York, USA","Universal Studios Florida, Universal Orlando Resort - 1000 Universal Studios Plaza, Orlando, Florida, USA"}'::text[]))
                                                         Rows Removed by Filter: 654224
                                                         Heap Blocks: exact=6972
                                                         Buffers: shared hit=1100 read=6392
                                                         ->  Bitmap Index Scan on info_type_id_movie_info  (cost=0.00..7077.68 rows=662032 width=0) (actual time=20.168..20.168 rows=660923 loops=1)
                                                               Index Cond: (info_type_id = 18)
                                                               Buffers: shared read=520
                                                   ->  Index Scan using title_pkey on title t  (cost=0.43..8.42 rows=1 width=8) (actual time=0.031..0.031 rows=1 loops=6699)
                                                         Index Cond: (id = mi1.movie_id)
                                                         Filter: ((production_year <= 2015) AND (production_year >= 1925))
                                                         Rows Removed by Filter: 0
                                                         Buffers: shared hit=22062 read=4734
                                             ->  Hash  (cost=1.10..1.10 rows=4 width=4) (actual time=0.017..0.018 rows=4 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   Buffers: shared hit=1
                                                   ->  Seq Scan on kind_type kt  (cost=0.00..1.10 rows=4 width=4) (actual time=0.007..0.009 rows=4 loops=1)
                                                         Filter: ((kind)::text = ANY ('{movie,"tv movie","tv series","video game"}'::text[]))
                                                         Rows Removed by Filter: 3
                                                         Buffers: shared hit=1
                                       ->  Index Scan using movie_id_movie_info on movie_info mi2  (cost=0.43..42.76 rows=1 width=8) (actual time=0.124..0.125 rows=0 loops=5462)
                                             Index Cond: (movie_id = t.id)
                                             Filter: ((info_type_id = 16) AND ((info)::text = ANY ('{"Australia:14 October 2004","Canada:27 September 2005","France:16 November 2004","Hungary:10 April 2004","Norway:11 May 2004","Philippines:30 May 2003","Portugal:10 October 2005",USA:2003,USA:2007,USA:2008,USA:2009,USA:2011,USA:2014}'::text[])))
                                             Rows Removed by Filter: 33
                                             Buffers: shared hit=41954 read=34027
                                 ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.006..0.011 rows=1 loops=122)
                                       Filter: (id = 18)
                                       Rows Removed by Filter: 112
                                       Buffers: shared hit=122
                           ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.005..0.009 rows=1 loops=122)
                                 Filter: (id = 16)
                                 Rows Removed by Filter: 112
                                 Buffers: shared hit=122
                     ->  Index Scan using movie_id_cast_info on cast_info ci  (cost=0.44..43.28 rows=38 width=12) (actual time=0.038..0.345 rows=28 loops=122)
                           Index Cond: (movie_id = t.id)
                           Buffers: shared hit=1462 read=2187
               ->  Hash  (cost=1.15..1.15 rows=2 width=4) (actual time=0.032..0.033 rows=2 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     Buffers: shared hit=1
                     ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=2 width=4) (actual time=0.025..0.027 rows=2 loops=1)
                           Filter: ((role)::text = ANY ('{cinematographer,guest}'::text[]))
                           Rows Removed by Filter: 10
                           Buffers: shared hit=1
         ->  Index Scan using name_pkey on name n  (cost=0.43..2.32 rows=1 width=4) (actual time=0.033..0.033 rows=1 loops=107)
               Index Cond: (id = ci.person_id)
               Filter: (((gender)::text = 'm'::text) OR (gender IS NULL))
               Rows Removed by Filter: 0
               Buffers: shared hit=308 read=120
 Planning:
   Buffers: shared hit=504 read=73
 Planning Time: 13.108 ms
 Execution Time: 1145.128 ms
(73 rows)

