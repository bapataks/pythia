                                                                                                                                                                                                                                                   QUERY PLAN                                                                                                                                                                                                                                                    
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=628066.84..628066.85 rows=1 width=8) (actual time=4086.164..4086.170 rows=1 loops=1)
   Buffers: shared hit=305384 read=121058
   ->  Nested Loop  (cost=7082.46..628066.74 rows=40 width=0) (actual time=21.118..4080.945 rows=42872 loops=1)
         Buffers: shared hit=305384 read=121058
         ->  Hash Join  (cost=7082.03..627946.12 rows=52 width=4) (actual time=21.079..2703.068 rows=42872 loops=1)
               Hash Cond: (ci.role_id = rt.id)
               Buffers: shared hit=154267 read=100687
               ->  Nested Loop  (cost=7080.85..627943.83 rows=315 width=8) (actual time=21.012..2680.658 rows=119146 loops=1)
                     Buffers: shared hit=154266 read=100687
                     ->  Nested Loop  (cost=7080.41..626983.33 rows=22 width=12) (actual time=20.979..1482.456 rows=2999 loops=1)
                           Buffers: shared hit=77886 read=52693
                           ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.033..0.041 rows=1 loops=1)
                                 Filter: (id = 18)
                                 Rows Removed by Filter: 112
                                 Buffers: shared hit=1
                           ->  Nested Loop  (cost=7080.41..626980.70 rows=22 width=16) (actual time=20.945..1481.772 rows=2999 loops=1)
                                 Buffers: shared hit=77885 read=52693
                                 ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.009..0.020 rows=1 loops=1)
                                       Filter: (id = 3)
                                       Rows Removed by Filter: 112
                                       Buffers: shared hit=1
                                 ->  Nested Loop  (cost=7080.41..626978.07 rows=22 width=20) (actual time=20.933..1481.103 rows=2999 loops=1)
                                       Buffers: shared hit=77884 read=52693
                                       ->  Hash Join  (cost=7079.98..562983.03 rows=1507 width=12) (actual time=20.819..668.351 rows=7103 loops=1)
                                             Hash Cond: (t.kind_id = kt.id)
                                             Buffers: shared hit=25751 read=13134
                                             ->  Nested Loop  (cost=7078.82..562970.75 rows=2638 width=16) (actual time=20.767..665.667 rows=7797 loops=1)
                                                   Buffers: shared hit=25750 read=13134
                                                   ->  Bitmap Heap Scan on movie_info mi2  (cost=7078.38..541072.13 rows=2823 width=8) (actual time=20.727..407.233 rows=7942 loops=1)
                                                         Recheck Cond: (info_type_id = 18)
                                                         Filter: ((info)::text = ANY ('{Australia,"Beverly Hills, California, USA","Brisbane, Queensland, Australia","Budapest, Hungary","Culver City, California, USA","Filmistan Studios, Mumbai, Maharashtra, India","Orange, California, USA",Philippines,"Portland, Oregon, USA","Salt Lake City, Utah, USA","Savannah, Georgia, USA","Sofia, Bulgaria","St. Petersburg, Russia","Tampa, Florida, USA","Van Nuys, Los Angeles, California, USA"}'::text[]))
                                                         Rows Removed by Filter: 652981
                                                         Heap Blocks: exact=6972
                                                         Buffers: shared hit=1145 read=6347
                                                         ->  Bitmap Index Scan on info_type_id_movie_info  (cost=0.00..7077.68 rows=662032 width=0) (actual time=19.810..19.810 rows=660923 loops=1)
                                                               Index Cond: (info_type_id = 18)
                                                               Buffers: shared read=520
                                                   ->  Memoize  (cost=0.44..7.77 rows=1 width=8) (actual time=0.032..0.032 rows=1 loops=7942)
                                                         Cache Key: mi2.movie_id
                                                         Cache Mode: logical
                                                         Hits: 94  Misses: 7848  Evictions: 0  Overflows: 0  Memory Usage: 823kB
                                                         Buffers: shared hit=24605 read=6787
                                                         ->  Index Scan using title_pkey on title t  (cost=0.43..7.76 rows=1 width=8) (actual time=0.031..0.031 rows=1 loops=7848)
                                                               Index Cond: (id = mi2.movie_id)
                                                               Filter: ((production_year <= 2015) AND (production_year >= 1925))
                                                               Rows Removed by Filter: 0
                                                               Buffers: shared hit=24605 read=6787
                                             ->  Hash  (cost=1.10..1.10 rows=4 width=4) (actual time=0.024..0.024 rows=4 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   Buffers: shared hit=1
                                                   ->  Seq Scan on kind_type kt  (cost=0.00..1.10 rows=4 width=4) (actual time=0.012..0.014 rows=4 loops=1)
                                                         Filter: ((kind)::text = ANY ('{episode,movie,"tv series","video movie"}'::text[]))
                                                         Rows Removed by Filter: 3
                                                         Buffers: shared hit=1
                                       ->  Index Scan using movie_id_movie_info on movie_info mi1  (cost=0.43..42.46 rows=1 width=8) (actual time=0.114..0.114 rows=0 loops=7103)
                                             Index Cond: (movie_id = t.id)
                                             Filter: ((info_type_id = 3) AND ((info)::text = ANY ('{Adventure,Documentary,Family,Horror,Mystery,Sci-Fi,Thriller}'::text[])))
                                             Rows Removed by Filter: 26
                                             Buffers: shared hit=52133 read=39559
                     ->  Index Scan using movie_id_cast_info on cast_info ci  (cost=0.44..43.28 rows=38 width=12) (actual time=0.035..0.391 rows=40 loops=2999)
                           Index Cond: (movie_id = t.id)
                           Buffers: shared hit=76380 read=47994
               ->  Hash  (cost=1.15..1.15 rows=2 width=4) (actual time=0.038..0.038 rows=2 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     Buffers: shared hit=1
                     ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=2 width=4) (actual time=0.027..0.031 rows=2 loops=1)
                           Filter: ((role)::text = ANY ('{actor,director}'::text[]))
                           Rows Removed by Filter: 10
                           Buffers: shared hit=1
         ->  Index Scan using name_pkey on name n  (cost=0.43..2.32 rows=1 width=4) (actual time=0.032..0.032 rows=1 loops=42872)
               Index Cond: (id = ci.person_id)
               Filter: (((gender)::text = ANY ('{f,m}'::text[])) OR (gender IS NULL))
               Buffers: shared hit=151117 read=20371
 Planning:
   Buffers: shared hit=504 read=70
 Planning Time: 13.422 ms
 Execution Time: 4086.953 ms
(77 rows)

