                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=700267.00..700267.01 rows=1 width=8) (actual time=21190.845..21190.854 rows=1 loops=1)
   Buffers: shared hit=1775372 read=431283, temp read=1176 written=1176
   ->  Nested Loop  (cost=69550.30..700266.57 rows=172 width=0) (actual time=263.034..21181.413 rows=51380 loops=1)
         Buffers: shared hit=1775372 read=431283, temp read=1176 written=1176
         ->  Hash Join  (cost=69549.87..699313.25 rows=411 width=4) (actual time=262.967..12556.404 rows=251213 loops=1)
               Hash Cond: (ci.role_id = rt.id)
               Buffers: shared hit=836285 read=365518, temp read=1176 written=1176
               ->  Nested Loop  (cost=69548.69..699303.32 rows=2465 width=8) (actual time=262.862..12369.758 rows=806182 loops=1)
                     Buffers: shared hit=836284 read=365518, temp read=1176 written=1176
                     ->  Nested Loop  (cost=69548.25..691780.81 rows=172 width=12) (actual time=262.832..3731.200 rows=29342 loops=1)
                           Buffers: shared hit=228421 read=96867, temp read=1176 written=1176
                           ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.024..0.033 rows=1 loops=1)
                                 Filter: (id = 4)
                                 Rows Removed by Filter: 112
                                 Buffers: shared hit=1
                           ->  Nested Loop  (cost=69548.25..691776.67 rows=172 width=16) (actual time=262.807..3724.479 rows=29342 loops=1)
                                 Buffers: shared hit=228420 read=96867, temp read=1176 written=1176
                                 ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.008..0.019 rows=1 loops=1)
                                       Filter: (id = 8)
                                       Rows Removed by Filter: 112
                                       Buffers: shared hit=1
                                 ->  Nested Loop  (cost=69548.25..691772.54 rows=172 width=20) (actual time=262.796..3717.526 rows=29342 loops=1)
                                       Buffers: shared hit=228419 read=96867, temp read=1176 written=1176
                                       ->  Hash Join  (cost=69547.82..443863.49 rows=5852 width=12) (actual time=262.751..836.491 rows=29363 loops=1)
                                             Hash Cond: (mi1.movie_id = t.id)
                                             Buffers: shared hit=15358 read=6325, temp read=1176 written=1176
                                             ->  Bitmap Heap Scan on movie_info mi1  (cost=14226.38..386821.67 rows=59428 width=8) (actual time=36.105..479.564 rows=632604 loops=1)
                                                   Recheck Cond: (info_type_id = 8)
                                                   Filter: ((info)::text = ANY ('{Australia,Belgium,Canada,USA}'::text[]))
                                                   Rows Removed by Filter: 692757
                                                   Heap Blocks: exact=7853
                                                   Buffers: shared hit=2756 read=6137
                                                   ->  Bitmap Index Scan on info_type_id_movie_info  (cost=0.00..14211.52 rows=1329478 width=0) (actual time=35.131..35.131 rows=1325361 loops=1)
                                                         Index Cond: (info_type_id = 8)
                                                         Buffers: shared hit=334 read=706
                                             ->  Hash  (cost=51236.40..51236.40 rows=248963 width=4) (actual time=128.790..128.793 rows=63769 loops=1)
                                                   Buckets: 262144  Batches: 2  Memory Usage: 3172kB
                                                   Buffers: shared hit=12602 read=188, temp written=93
                                                   ->  Nested Loop  (cost=4565.45..51236.40 rows=248963 width=4) (actual time=5.388..118.836 rows=63769 loops=1)
                                                         Buffers: shared hit=12602 read=188
                                                         ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.010..0.012 rows=1 loops=1)
                                                               Filter: ((kind)::text = 'tv movie'::text)
                                                               Rows Removed by Filter: 6
                                                               Buffers: shared hit=1
                                                         ->  Bitmap Heap Scan on title t  (cost=4565.45..48330.74 rows=290457 width=8) (actual time=5.375..114.920 rows=63769 loops=1)
                                                               Recheck Cond: (kind_id = kt.id)
                                                               Filter: ((production_year <= 2015) AND (1990 < production_year))
                                                               Rows Removed by Filter: 36768
                                                               Heap Blocks: exact=12708
                                                               Buffers: shared hit=12601 read=188
                                                               ->  Bitmap Index Scan on kind_id_title  (cost=0.00..4492.84 rows=421388 width=0) (actual time=3.845..3.845 rows=100537 loops=1)
                                                                     Index Cond: (kind_id = kt.id)
                                                                     Buffers: shared read=81
                                       ->  Index Scan using movie_id_movie_info on movie_info mi2  (cost=0.43..42.35 rows=1 width=8) (actual time=0.036..0.097 rows=1 loops=29363)
                                             Index Cond: (movie_id = t.id)
                                             Filter: ((info_type_id = 4) AND ((info)::text = ANY ('{Dutch,English,French,Spanish}'::text[])))
                                             Rows Removed by Filter: 9
                                             Buffers: shared hit=213061 read=90542
                     ->  Index Scan using movie_id_cast_info on cast_info ci  (cost=0.44..43.36 rows=38 width=12) (actual time=0.035..0.287 rows=27 loops=29342)
                           Index Cond: (movie_id = t.id)
                           Buffers: shared hit=607863 read=268651
               ->  Hash  (cost=1.15..1.15 rows=2 width=4) (actual time=0.032..0.033 rows=2 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     Buffers: shared hit=1
                     ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=2 width=4) (actual time=0.023..0.026 rows=2 loops=1)
                           Filter: ((role)::text = ANY ('{"miscellaneous crew",producer}'::text[]))
                           Rows Removed by Filter: 10
                           Buffers: shared hit=1
         ->  Index Scan using name_pkey on name n  (cost=0.43..2.32 rows=1 width=4) (actual time=0.034..0.034 rows=0 loops=251213)
               Index Cond: (id = ci.person_id)
               Filter: ((gender)::text = 'm'::text)
               Rows Removed by Filter: 1
               Buffers: shared hit=939087 read=65765
 Planning:
   Buffers: shared hit=530 read=44
 Planning Time: 13.736 ms
 Execution Time: 21191.516 ms
(77 rows)

