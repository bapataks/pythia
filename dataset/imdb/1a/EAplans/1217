                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=706165.08..706165.09 rows=1 width=8) (actual time=6839.126..6839.134 rows=1 loops=1)
   Buffers: shared hit=539037 read=110901, temp read=2228 written=2228
   ->  Nested Loop  (cost=470550.91..706164.90 rows=74 width=0) (actual time=1066.064..6837.979 rows=8676 loops=1)
         Buffers: shared hit=539037 read=110901, temp read=2228 written=2228
         ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.047..0.055 rows=1 loops=1)
               Filter: (id = 7)
               Rows Removed by Filter: 112
               Buffers: shared hit=1
         ->  Nested Loop  (cost=470550.91..706161.74 rows=74 width=4) (actual time=1066.015..6836.779 rows=8676 loops=1)
               Buffers: shared hit=539036 read=110901, temp read=2228 written=2228
               ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.009..0.018 rows=1 loops=1)
                     Filter: (id = 3)
                     Rows Removed by Filter: 112
                     Buffers: shared hit=1
               ->  Nested Loop  (cost=470550.91..706158.59 rows=74 width=8) (actual time=1066.003..6835.499 rows=8676 loops=1)
                     Join Filter: (t.id = mi2.movie_id)
                     Buffers: shared hit=539035 read=110901, temp read=2228 written=2228
                     ->  Nested Loop  (cost=470550.47..625037.47 rows=1914 width=16) (actual time=1048.137..5916.646 rows=7899 loops=1)
                           Buffers: shared hit=474158 read=76828, temp read=2228 written=2228
                           ->  Hash Join  (cost=470550.04..605922.31 rows=8241 width=20) (actual time=1038.813..2569.902 rows=120425 loops=1)
                                 Hash Cond: (ci.movie_id = t.id)
                                 Buffers: shared hit=17287 read=51999, temp read=2228 written=2228
                                 ->  Nested Loop  (cost=0.44..123965.00 rows=3020080 width=8) (actual time=0.109..1022.979 rows=2728943 loops=1)
                                       Buffers: shared hit=3102 read=18817
                                       ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.009..0.012 rows=1 loops=1)
                                             Filter: ((role)::text = 'writer'::text)
                                             Rows Removed by Filter: 11
                                             Buffers: shared hit=1
                                       ->  Index Scan using role_id_cast_info on cast_info ci  (cost=0.44..91017.52 rows=3294633 width=12) (actual time=0.097..674.734 rows=2728943 loops=1)
                                             Index Cond: (role_id = rt.id)
                                             Buffers: shared hit=3101 read=18817
                                 ->  Hash  (cost=470463.37..470463.37 rows=6899 width=12) (actual time=1038.563..1038.568 rows=91107 loops=1)
                                       Buckets: 131072 (originally 8192)  Batches: 1 (originally 1)  Memory Usage: 4939kB
                                       Buffers: shared hit=14185 read=33182, temp read=2228 written=2228
                                       ->  Hash Join  (cost=95199.22..470463.37 rows=6899 width=12) (actual time=533.839..1023.660 rows=91107 loops=1)
                                             Hash Cond: (mi1.movie_id = t.id)
                                             Buffers: shared hit=14185 read=33182, temp read=2228 written=2228
                                             ->  Bitmap Heap Scan on movie_info mi1  (cost=16474.46..389811.14 rows=103860 width=8) (actual time=42.202..320.806 rows=1011566 loops=1)
                                                   Recheck Cond: (info_type_id = 3)
                                                   Filter: ((info)::text = ANY ('{Action,Animation,Crime,Documentary,Drama,Fantasy,Horror,Mystery,Romance,Short}'::text[]))
                                                   Rows Removed by Filter: 522343
                                                   Heap Blocks: exact=9772
                                                   Buffers: shared hit=1 read=10974
                                                   ->  Bitmap Index Scan on info_type_id_movie_info  (cost=0.00..16448.47 rows=1538671 width=0) (actual time=41.004..41.004 rows=1533909 loops=1)
                                                         Index Cond: (info_type_id = 3)
                                                         Buffers: shared read=1203
                                             ->  Hash  (cost=75968.50..75968.50 rows=167941 width=4) (actual time=490.499..490.502 rows=342123 loops=1)
                                                   Buckets: 262144  Batches: 2  Memory Usage: 8082kB
                                                   Buffers: shared hit=14184 read=22208, temp written=499
                                                   ->  Hash Join  (cost=1.13..75968.50 rows=167941 width=4) (actual time=0.051..434.283 rows=342123 loops=1)
                                                         Hash Cond: (t.kind_id = kt.id)
                                                         Buffers: shared hit=14184 read=22208
                                                         ->  Seq Scan on title t  (cost=0.00..74315.95 rows=391862 width=8) (actual time=0.025..390.380 rows=386415 loops=1)
                                                               Filter: ((production_year <= 1997) AND (1981 < production_year))
                                                               Rows Removed by Filter: 2141897
                                                               Buffers: shared hit=14183 read=22208
                                                         ->  Hash  (cost=1.10..1.10 rows=3 width=4) (actual time=0.016..0.017 rows=3 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               Buffers: shared hit=1
                                                               ->  Seq Scan on kind_type kt  (cost=0.00..1.10 rows=3 width=4) (actual time=0.008..0.009 rows=3 loops=1)
                                                                     Filter: ((kind)::text = ANY ('{episode,movie,"tv movie"}'::text[]))
                                                                     Rows Removed by Filter: 4
                                                                     Buffers: shared hit=1
                           ->  Index Scan using name_pkey on name n  (cost=0.43..2.32 rows=1 width=4) (actual time=0.027..0.027 rows=0 loops=120425)
                                 Index Cond: (id = ci.person_id)
                                 Filter: ((gender)::text = 'f'::text)
                                 Rows Removed by Filter: 1
                                 Buffers: shared hit=456871 read=24829
                     ->  Index Scan using movie_id_movie_info on movie_info mi2  (cost=0.43..42.37 rows=1 width=8) (actual time=0.080..0.116 rows=1 loops=7899)
                           Index Cond: (movie_id = ci.movie_id)
                           Filter: ((info_type_id = 7) AND ((info)::text = ANY ('{"CAM:Panavision Cameras and Lenses","OFM:16 mm","OFM:35 mm",PCS:Spherical,"PFM:16 mm","PFM:35 mm","RAT:1.33 : 1","RAT:1.85 : 1"}'::text[])))
                           Rows Removed by Filter: 25
                           Buffers: shared hit=64877 read=34073
 Planning:
   Buffers: shared hit=523 read=54
 Planning Time: 13.910 ms
 Execution Time: 6839.794 ms
(77 rows)

