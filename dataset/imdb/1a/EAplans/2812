                                                                                                                                                                                                                  QUERY PLAN                                                                                                                                                                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=388361.90..388361.91 rows=1 width=8) (actual time=4222.002..4222.010 rows=1 loops=1)
   Buffers: shared hit=352883 read=80404
   ->  Nested Loop  (cost=7081.98..388361.89 rows=4 width=0) (actual time=36.804..4217.977 rows=26623 loops=1)
         Buffers: shared hit=352883 read=80404
         ->  Hash Join  (cost=7081.55..388350.29 rows=5 width=4) (actual time=36.758..3308.707 rows=26623 loops=1)
               Hash Cond: (ci.role_id = rt.id)
               Buffers: shared hit=255470 read=71325
               ->  Nested Loop  (cost=7080.37..388349.02 rows=29 width=8) (actual time=21.359..3284.710 rows=122448 loops=1)
                     Buffers: shared hit=255469 read=71325
                     ->  Nested Loop  (cost=7079.93..388259.91 rows=2 width=12) (actual time=21.327..2014.617 rows=3678 loops=1)
                           Buffers: shared hit=158977 read=37093
                           ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.023..0.032 rows=1 loops=1)
                                 Filter: (id = 3)
                                 Rows Removed by Filter: 112
                                 Buffers: shared hit=1
                           ->  Nested Loop  (cost=7079.93..388257.48 rows=2 width=16) (actual time=21.303..2013.715 rows=3678 loops=1)
                                 Buffers: shared hit=158976 read=37093
                                 ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.008..0.019 rows=1 loops=1)
                                       Filter: (id = 18)
                                       Rows Removed by Filter: 112
                                       Buffers: shared hit=1
                                 ->  Nested Loop  (cost=7079.93..388255.05 rows=2 width=20) (actual time=21.293..2012.787 rows=3678 loops=1)
                                       Buffers: shared hit=158975 read=37093
                                       ->  Hash Join  (cost=7079.50..384408.05 rows=89 width=12) (actual time=21.229..1270.618 rows=4892 loops=1)
                                             Hash Cond: (t.kind_id = kt.id)
                                             Buffers: shared hit=118974 read=9295
                                             ->  Nested Loop  (cost=7078.34..384406.24 rows=156 width=16) (actual time=21.196..1267.287 rows=9101 loops=1)
                                                   Buffers: shared hit=118973 read=9295
                                                   ->  Bitmap Heap Scan on movie_info mi1  (cost=7077.91..377307.73 rows=863 width=8) (actual time=21.108..274.225 rows=30194 loops=1)
                                                         Recheck Cond: (info_type_id = 18)
                                                         Filter: ((info)::text = ANY ('{"Bavaria Filmstudios, Geiselgasteig, Grünwald, Bavaria, Germany","Cinecittà Studios, Cinecittà, Rome, Lazio, Italy","Helsinki, Finland","Manhattan, New York City, New York, USA","New York City, New York, USA","Paris, France","Prague, Czech Republic","Republic Studios, Hollywood, Los Angeles, California, USA","Rome, Lazio, Italy"}'::text[]))
                                                         Rows Removed by Filter: 630729
                                                         Heap Blocks: exact=6972
                                                         Buffers: shared hit=674 read=6818
                                                         ->  Bitmap Index Scan on info_type_id_movie_info  (cost=0.00..7077.68 rows=662032 width=0) (actual time=20.239..20.239 rows=660923 loops=1)
                                                               Index Cond: (info_type_id = 18)
                                                               Buffers: shared hit=1 read=519
                                                   ->  Index Scan using title_pkey on title t  (cost=0.43..8.23 rows=1 width=8) (actual time=0.032..0.032 rows=0 loops=30194)
                                                         Index Cond: (id = mi1.movie_id)
                                                         Filter: ((production_year <= 1975) AND (production_year >= 1875))
                                                         Rows Removed by Filter: 1
                                                         Buffers: shared hit=118299 read=2477
                                             ->  Hash  (cost=1.10..1.10 rows=4 width=4) (actual time=0.014..0.015 rows=4 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   Buffers: shared hit=1
                                                   ->  Seq Scan on kind_type kt  (cost=0.00..1.10 rows=4 width=4) (actual time=0.007..0.009 rows=4 loops=1)
                                                         Filter: ((kind)::text = ANY ('{movie,"tv movie","tv series","video movie"}'::text[]))
                                                         Rows Removed by Filter: 3
                                                         Buffers: shared hit=1
                                       ->  Index Scan using movie_id_movie_info on movie_info mi2  (cost=0.43..43.21 rows=1 width=8) (actual time=0.150..0.151 rows=1 loops=4892)
                                             Index Cond: (movie_id = t.id)
                                             Filter: ((info_type_id = 3) AND ((info)::text = ANY ('{Action,Documentary,Drama,Family,Film-Noir,History,Romance,Sci-Fi,Thriller,War}'::text[])))
                                             Rows Removed by Filter: 25
                                             Buffers: shared hit=40001 read=27798
                     ->  Index Scan using movie_id_cast_info on cast_info ci  (cost=0.44..44.17 rows=38 width=12) (actual time=0.038..0.337 rows=33 loops=3678)
                           Index Cond: (movie_id = t.id)
                           Buffers: shared hit=96492 read=34232
               ->  Hash  (cost=1.15..1.15 rows=2 width=4) (actual time=0.029..0.030 rows=2 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     Buffers: shared hit=1
                     ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=2 width=4) (actual time=0.022..0.024 rows=2 loops=1)
                           Filter: ((role)::text = ANY ('{actress,"costume designer"}'::text[]))
                           Rows Removed by Filter: 10
                           Buffers: shared hit=1
         ->  Index Scan using name_pkey on name n  (cost=0.43..2.32 rows=1 width=4) (actual time=0.034..0.034 rows=1 loops=26623)
               Index Cond: (id = ci.person_id)
               Filter: (((gender)::text = ANY ('{f,m}'::text[])) OR (gender IS NULL))
               Buffers: shared hit=97413 read=9079
 Planning:
   Buffers: shared hit=577
 Planning Time: 13.285 ms
 Execution Time: 4222.504 ms
(72 rows)

