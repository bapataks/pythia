                                                                                               QUERY PLAN                                                                                               
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=675142.37..675142.38 rows=1 width=8) (actual time=28033.958..28033.966 rows=1 loops=1)
   Buffers: shared hit=2587777 read=337830
   ->  Nested Loop  (cost=14219.06..675141.85 rows=210 width=0) (actual time=39.125..28030.409 rows=12676 loops=1)
         Buffers: shared hit=2587777 read=337830
         ->  Hash Join  (cost=14218.63..674394.96 rows=322 width=4) (actual time=36.178..26169.912 rows=49791 loops=1)
               Hash Cond: (ci.role_id = rt.id)
               Buffers: shared hit=2405739 read=320704
               ->  Nested Loop  (cost=14217.45..674386.92 rows=1935 width=8) (actual time=36.099..25967.165 rows=1091049 loops=1)
                     Buffers: shared hit=2405738 read=320704
                     ->  Nested Loop  (cost=14217.01..668487.73 rows=135 width=12) (actual time=36.057..14091.980 rows=53880 loops=1)
                           Buffers: shared hit=1378461 read=122003
                           ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.024..0.037 rows=1 loops=1)
                                 Filter: (id = 4)
                                 Rows Removed by Filter: 112
                                 Buffers: shared hit=1
                           ->  Nested Loop  (cost=14217.01..668483.97 rows=135 width=16) (actual time=36.032..14077.955 rows=53880 loops=1)
                                 Buffers: shared hit=1378460 read=122003
                                 ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.006..0.020 rows=1 loops=1)
                                       Filter: (id = 8)
                                       Rows Removed by Filter: 112
                                       Buffers: shared hit=1
                                 ->  Nested Loop  (cost=14217.01..668480.20 rows=135 width=20) (actual time=36.023..14063.718 rows=53880 loops=1)
                                       Buffers: shared hit=1378459 read=122003
                                       ->  Hash Join  (cost=14216.58..468572.88 rows=4699 width=12) (actual time=35.939..6199.668 rows=89673 loops=1)
                                             Hash Cond: (t.kind_id = kt.id)
                                             Buffers: shared hit=593689 read=37805
                                             ->  Nested Loop  (cost=14215.44..468525.54 rows=10964 width=16) (actual time=35.637..6149.618 rows=109614 loops=1)
                                                   Buffers: shared hit=593688 read=37805
                                                   ->  Bitmap Heap Scan on movie_info mi1  (cost=14215.00..386810.30 rows=13840 width=8) (actual time=35.593..460.899 rows=157334 loops=1)
                                                         Recheck Cond: (info_type_id = 8)
                                                         Filter: ((info)::text = ANY ('{Argentina,Brazil,Chile,"Czech Republic",Denmark,France,Greece,India,"South Korea"}'::text[]))
                                                         Rows Removed by Filter: 1168027
                                                         Heap Blocks: exact=7853
                                                         Buffers: shared hit=1452 read=7441
                                                         ->  Bitmap Index Scan on info_type_id_movie_info  (cost=0.00..14211.52 rows=1329478 width=0) (actual time=33.814..33.814 rows=1325361 loops=1)
                                                               Index Cond: (info_type_id = 8)
                                                               Buffers: shared read=1040
                                                   ->  Memoize  (cost=0.44..6.00 rows=1 width=8) (actual time=0.036..0.036 rows=1 loops=157334)
                                                         Cache Key: mi1.movie_id
                                                         Cache Mode: logical
                                                         Hits: 1684  Misses: 155650  Evictions: 65614  Overflows: 0  Memory Usage: 8193kB
                                                         Buffers: shared hit=592236 read=30364
                                                         ->  Index Scan using title_pkey on title t  (cost=0.43..5.99 rows=1 width=8) (actual time=0.035..0.035 rows=1 loops=155650)
                                                               Index Cond: (id = mi1.movie_id)
                                                               Filter: ((production_year <= 2015) AND (1975 < production_year))
                                                               Rows Removed by Filter: 0
                                                               Buffers: shared hit=592236 read=30364
                                             ->  Hash  (cost=1.10..1.10 rows=3 width=4) (actual time=0.015..0.015 rows=3 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   Buffers: shared hit=1
                                                   ->  Seq Scan on kind_type kt  (cost=0.00..1.10 rows=3 width=4) (actual time=0.006..0.008 rows=3 loops=1)
                                                         Filter: ((kind)::text = ANY ('{episode,movie,"video movie"}'::text[]))
                                                         Rows Removed by Filter: 4
                                                         Buffers: shared hit=1
                                       ->  Index Scan using movie_id_movie_info on movie_info mi2  (cost=0.43..42.53 rows=1 width=8) (actual time=0.059..0.087 rows=1 loops=89673)
                                             Index Cond: (movie_id = t.id)
                                             Filter: ((info_type_id = 4) AND ((info)::text = ANY ('{Czech,Danish,English,Greek,Hindi,Korean,Portuguese,Spanish}'::text[])))
                                             Rows Removed by Filter: 10
                                             Buffers: shared hit=784770 read=84198
                     ->  Index Scan using movie_id_cast_info on cast_info ci  (cost=0.44..43.32 rows=38 width=12) (actual time=0.036..0.214 rows=20 loops=53880)
                           Index Cond: (movie_id = t.id)
                           Buffers: shared hit=1027277 read=198701
               ->  Hash  (cost=1.15..1.15 rows=2 width=4) (actual time=0.030..0.030 rows=2 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     Buffers: shared hit=1
                     ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=2 width=4) (actual time=0.023..0.024 rows=2 loops=1)
                           Filter: ((role)::text = ANY ('{cinematographer,"production designer"}'::text[]))
                           Rows Removed by Filter: 10
                           Buffers: shared hit=1
         ->  Index Scan using name_pkey on name n  (cost=0.43..2.32 rows=1 width=4) (actual time=0.037..0.037 rows=0 loops=49791)
               Index Cond: (id = ci.person_id)
               Filter: ((gender)::text = ANY ('{f,m}'::text[]))
               Rows Removed by Filter: 1
               Buffers: shared hit=182038 read=17126
 Planning:
   Buffers: shared hit=531 read=46
 Planning Time: 10.429 ms
 Execution Time: 28036.573 ms
(78 rows)

